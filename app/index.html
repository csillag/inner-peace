<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>The Search For Inner[Text] Peace</title>
  <link rel="stylesheet" href="css/app.css"/>
</head>
<body>
  <script src="lib/angular/angular.js"></script>
  <!-- In production use:
  <script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.0.3/angular.min.js"></script>
  -->

  <!-- Allows for coffeescript compiling on the fly.                                    -->
  <!-- Not recommended for production use. See http://coffeescript.org/#scripts.        -->
  <script src="lib/coffeescript/coffee-script.js"></script>
  <script src="lib/diff_match_patch/diff_match_patch.js"></script>
  <script src="lib/fancymatcher/fancymatcher.coffee" type="text/coffeescript"></script>
  <script src="lib/domsearcher/domsearcher.coffee" type="text/coffeescript"></script>

  <script src="coffee/services.coffee" type="text/coffeescript"></script>
  <script src="coffee/controllers.coffee" type="text/coffeescript"></script>
  <script src="coffee/filters.coffee" type="text/coffeescript"></script>
  <script src="coffee/directives.coffee" type="text/coffeescript"></script>
  <script src="coffee/app.coffee" type="text/coffeescript"></script>

  <h1>The Search for Inner[Text] Peace</h1>
  
  <div ng-controller="SearchController">
    HTML input source:
    <select ng-model="sourceMode">
      <option value="local">Input HTML source manually</option>
      <option value="page">Use this page</option>
      <option value="sample1">Use sample article 1</option>
    </select>

    <div id="source-spec" class="shown-{{sourceModeNeedsInput}}">
      <div class="shown-{{sourceMode=='local'}}">
	<p>Test html source:</p>
	<textarea ng-model="localSource" id="source-editor"></textArea>
	<button ng-click="render()">Render it!</button>
      </div>

      <div class="shown-{{sourceMode=='page'}}">
	<p>OK, so you want to test out the stuff on this very page.</p>
      </div>
    </div>

    <div id="search-input" class="shown-{{canSearch}}">
      <form name="SearchForm">
        DOM element to scan:
	<select ng-model="selectedPath" ng-options="path for path in paths"></select>
        <hr />
	Search term:
	<input type="text" ng-model="searchTerm" required="true">
	Search position:
	<input type="number" ng-model="searchPos" min="0">
	<button ng-click="search()">Search!</button>
      </form>
    </div>

    <div id="search-results" class="shown-{{searchResults.length>0 || detailedResults.length>0}}">
      {{searchResults}}
      <div id="search-matching-elements" class="shown-{{detailedResults.length>0}}">
	<p>Involved elements:</p>
	<table border="1">
	  <thead>
	    <tr>
	      <th>Path</th>
	      <th>Text</th>
	      <th>Full</th>
	      <th>From</th>
	      <th>Till</th>
	    </tr>
	  </thead>
	  <tbody>
	    <tr ng-repeat="match in detailedResults">
	      <td>{{match.path}}</td>
	      <td>{{match.text}}</td>
	      <td>{{match.full | booleanCheckmark}}</td>
	      <td>{{match.start}}</td>
	      <td>{{match.end}}</td>
	    </tr>
	  </tbody>
	</table>
      </div>
    </div>
    <div class="shown-{{renderSource != null}}">
      <h2>DOM rendered as:</h2>
      <div id="rendered-dom" ng-bind-html-unsafe="renderSource"></div>
    </div>
  </div>
</body>
</html>
